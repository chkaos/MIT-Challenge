<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>23.Peer-to-peer: Bitcoin | CHKAOS</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/note/egg.png">
    <meta name="description" content="My Note Collection">
    
    <link rel="preload" href="/note/assets/css/0.styles.ba589cc9.css" as="style"><link rel="preload" href="/note/assets/js/app.d5006f3d.js" as="script"><link rel="preload" href="/note/assets/js/2.65e5b2f3.js" as="script"><link rel="preload" href="/note/assets/js/104.1b5b375d.js" as="script"><link rel="prefetch" href="/note/assets/js/10.ae2f2d04.js"><link rel="prefetch" href="/note/assets/js/100.c68d38be.js"><link rel="prefetch" href="/note/assets/js/101.fd3e754f.js"><link rel="prefetch" href="/note/assets/js/102.5c217b08.js"><link rel="prefetch" href="/note/assets/js/103.449bcd79.js"><link rel="prefetch" href="/note/assets/js/105.a61b2017.js"><link rel="prefetch" href="/note/assets/js/106.e81cfff0.js"><link rel="prefetch" href="/note/assets/js/107.a75923b3.js"><link rel="prefetch" href="/note/assets/js/108.891948b3.js"><link rel="prefetch" href="/note/assets/js/109.a2545875.js"><link rel="prefetch" href="/note/assets/js/11.4ab4a5a3.js"><link rel="prefetch" href="/note/assets/js/110.6d0886e8.js"><link rel="prefetch" href="/note/assets/js/12.255d9150.js"><link rel="prefetch" href="/note/assets/js/13.794e7ac8.js"><link rel="prefetch" href="/note/assets/js/14.d32c7fdd.js"><link rel="prefetch" href="/note/assets/js/15.67cfbf95.js"><link rel="prefetch" href="/note/assets/js/16.3c73a976.js"><link rel="prefetch" href="/note/assets/js/17.8806b699.js"><link rel="prefetch" href="/note/assets/js/18.378bd860.js"><link rel="prefetch" href="/note/assets/js/19.48c8434f.js"><link rel="prefetch" href="/note/assets/js/20.1fdb582e.js"><link rel="prefetch" href="/note/assets/js/21.3e08c9be.js"><link rel="prefetch" href="/note/assets/js/22.810fe1a0.js"><link rel="prefetch" href="/note/assets/js/23.5ba70e2d.js"><link rel="prefetch" href="/note/assets/js/24.9681b927.js"><link rel="prefetch" href="/note/assets/js/25.c0e5deaa.js"><link rel="prefetch" href="/note/assets/js/26.aae4bdc7.js"><link rel="prefetch" href="/note/assets/js/27.7f17e5f5.js"><link rel="prefetch" href="/note/assets/js/28.61ef96a0.js"><link rel="prefetch" href="/note/assets/js/29.f8d63307.js"><link rel="prefetch" href="/note/assets/js/3.031640f4.js"><link rel="prefetch" href="/note/assets/js/30.817d5cd9.js"><link rel="prefetch" href="/note/assets/js/31.e4ea696a.js"><link rel="prefetch" href="/note/assets/js/32.aba63c9c.js"><link rel="prefetch" href="/note/assets/js/33.1aa6facd.js"><link rel="prefetch" href="/note/assets/js/34.69d2bc3f.js"><link rel="prefetch" href="/note/assets/js/35.f82bd55f.js"><link rel="prefetch" href="/note/assets/js/36.20a42b33.js"><link rel="prefetch" href="/note/assets/js/37.7ab6c748.js"><link rel="prefetch" href="/note/assets/js/38.04cf7e1e.js"><link rel="prefetch" href="/note/assets/js/39.87ad9256.js"><link rel="prefetch" href="/note/assets/js/4.0876ef1d.js"><link rel="prefetch" href="/note/assets/js/40.fa12820d.js"><link rel="prefetch" href="/note/assets/js/41.22bd816e.js"><link rel="prefetch" href="/note/assets/js/42.c107915c.js"><link rel="prefetch" href="/note/assets/js/43.983b5fc5.js"><link rel="prefetch" href="/note/assets/js/44.75f6ceb2.js"><link rel="prefetch" href="/note/assets/js/45.98830da6.js"><link rel="prefetch" href="/note/assets/js/46.550f0b22.js"><link rel="prefetch" href="/note/assets/js/47.8fbd223c.js"><link rel="prefetch" href="/note/assets/js/48.edf4b3f9.js"><link rel="prefetch" href="/note/assets/js/49.7508a3de.js"><link rel="prefetch" href="/note/assets/js/5.369c3e08.js"><link rel="prefetch" href="/note/assets/js/50.04715961.js"><link rel="prefetch" href="/note/assets/js/51.277d9998.js"><link rel="prefetch" href="/note/assets/js/52.ebc26274.js"><link rel="prefetch" href="/note/assets/js/53.471c676f.js"><link rel="prefetch" href="/note/assets/js/54.9e46fdf4.js"><link rel="prefetch" href="/note/assets/js/55.8a98c441.js"><link rel="prefetch" href="/note/assets/js/56.b5f6e00a.js"><link rel="prefetch" href="/note/assets/js/57.f6fb0c39.js"><link rel="prefetch" href="/note/assets/js/58.d92a7b7d.js"><link rel="prefetch" href="/note/assets/js/59.33c88c84.js"><link rel="prefetch" href="/note/assets/js/6.34251819.js"><link rel="prefetch" href="/note/assets/js/60.68db27af.js"><link rel="prefetch" href="/note/assets/js/61.ce3eefe1.js"><link rel="prefetch" href="/note/assets/js/62.a3e76ed5.js"><link rel="prefetch" href="/note/assets/js/63.b9084887.js"><link rel="prefetch" href="/note/assets/js/64.e1d868ed.js"><link rel="prefetch" href="/note/assets/js/65.0d77e0a0.js"><link rel="prefetch" href="/note/assets/js/66.fe465e07.js"><link rel="prefetch" href="/note/assets/js/67.76ca73a0.js"><link rel="prefetch" href="/note/assets/js/68.2498dd7c.js"><link rel="prefetch" href="/note/assets/js/69.f03ab615.js"><link rel="prefetch" href="/note/assets/js/7.273a5831.js"><link rel="prefetch" href="/note/assets/js/70.cad85a7e.js"><link rel="prefetch" href="/note/assets/js/71.5dcb8b9a.js"><link rel="prefetch" href="/note/assets/js/72.827102a3.js"><link rel="prefetch" href="/note/assets/js/73.315b5fe4.js"><link rel="prefetch" href="/note/assets/js/74.def8de65.js"><link rel="prefetch" href="/note/assets/js/75.a54fced2.js"><link rel="prefetch" href="/note/assets/js/76.6cae1891.js"><link rel="prefetch" href="/note/assets/js/77.12cb32b9.js"><link rel="prefetch" href="/note/assets/js/78.5994be50.js"><link rel="prefetch" href="/note/assets/js/79.bbc37f01.js"><link rel="prefetch" href="/note/assets/js/8.ba3fa28e.js"><link rel="prefetch" href="/note/assets/js/80.eeb65418.js"><link rel="prefetch" href="/note/assets/js/81.f876286e.js"><link rel="prefetch" href="/note/assets/js/82.a58003e1.js"><link rel="prefetch" href="/note/assets/js/83.13c9c65b.js"><link rel="prefetch" href="/note/assets/js/84.dca226ee.js"><link rel="prefetch" href="/note/assets/js/85.38911042.js"><link rel="prefetch" href="/note/assets/js/86.4f2e3cde.js"><link rel="prefetch" href="/note/assets/js/87.bb576b86.js"><link rel="prefetch" href="/note/assets/js/88.ba3e1a83.js"><link rel="prefetch" href="/note/assets/js/89.cc281bcf.js"><link rel="prefetch" href="/note/assets/js/9.557b7160.js"><link rel="prefetch" href="/note/assets/js/90.b68af197.js"><link rel="prefetch" href="/note/assets/js/91.a0945e77.js"><link rel="prefetch" href="/note/assets/js/92.accc5e5d.js"><link rel="prefetch" href="/note/assets/js/93.682fd046.js"><link rel="prefetch" href="/note/assets/js/94.c47d39d0.js"><link rel="prefetch" href="/note/assets/js/95.6363826c.js"><link rel="prefetch" href="/note/assets/js/96.36edf40e.js"><link rel="prefetch" href="/note/assets/js/97.75b6c735.js"><link rel="prefetch" href="/note/assets/js/98.8b5d3421.js"><link rel="prefetch" href="/note/assets/js/99.e03485fe.js">
    <link rel="stylesheet" href="/note/assets/css/0.styles.ba589cc9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/note/" class="home-link router-link-active"><img src="/note/favicon.png" alt="CHKAOS" class="logo"> <span class="site-name can-hide">CHKAOS</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/note/MIT/" class="nav-link">
  Mit
</a></div><div class="nav-item"><a href="/note/Leetcode/" class="nav-link">
  Leetcode
</a></div><div class="nav-item"><a href="/note/Interview/" class="nav-link">
  Interview
</a></div><div class="nav-item"><a href="http://chkaos.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/chkaos/note" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/note/MIT/" class="nav-link">
  Mit
</a></div><div class="nav-item"><a href="/note/Leetcode/" class="nav-link">
  Leetcode
</a></div><div class="nav-item"><a href="/note/Interview/" class="nav-link">
  Interview
</a></div><div class="nav-item"><a href="http://chkaos.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/chkaos/note" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/note/mit/" aria-current="page" class="sidebar-link">前言</a></li><li><a href="/note/mit/schedule.html" class="sidebar-link">计划</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机科学与编程导论(python)</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机科学数学</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>电子工程与计算机科学导论1</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>电子工程与计算机科学导论2(交流网络)</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法导论</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>软件构造</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机网络导论</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>操作系统</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>分布式系统</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/note/mit/fen-bu-shi-xi-tong/" aria-current="page" class="sidebar-link">6.824 分布式系统</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/01.html" class="sidebar-link">Introduction</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/02.html" class="sidebar-link">2: Infrastructure: RPC and threads</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/03.html" class="sidebar-link">3.Fault Tolerance: primary/backup replication</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/04.html" class="sidebar-link">4.Fault Tolerance: FDS Case Study</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/05.html" class="sidebar-link">5: Fault Tolerance:Paxos</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/06.html" class="sidebar-link">6: Fault Tolerance:Raft</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/07.html" class="sidebar-link">7.Guest lecturer: Russ Cox (Google/Go)</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/08.html" class="sidebar-link">8.Case Studies: Replicated File System -- Harp</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/09.html" class="sidebar-link">9. Distributed Computing: Sequential consistency</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/10.html" class="sidebar-link">10.Distributed Computing: Relaxed consistency</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/11.html" class="sidebar-link">11.Disconnected Operation: Version Vectors and File Synchronization</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/12.html" class="sidebar-link">13.Disconnected Operation: Eventual Consistency</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/13.html" class="sidebar-link">13.MapReduce revisited</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/14.html" class="sidebar-link">14.Spark Case Study</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/15.html" class="sidebar-link">15.Guest lecturer: Wilson Hsieh (Google)</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/16.html" class="sidebar-link">16.Scaling Memcache at Facebook</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/17.html" class="sidebar-link">17.Case Studies: Relaxed Consistency-PNUTS</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/18.html" class="sidebar-link">18. Case Studies:Dynamo</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/19.html" class="sidebar-link">19.Distributed systems in the real world (Guest lecturer: Emil Sit)</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/20.html" class="sidebar-link">20.Atomicity: Two-Phase Commit</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/21.html" class="sidebar-link">21.Atomicity: Optimistic Concurrency Control</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/22.html" class="sidebar-link">22.Peer-to-peer: Trackerless Bittorrent and DHTs</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/23.html" aria-current="page" class="active sidebar-link">23.Peer-to-peer: Bitcoin</a></li><li><a href="/note/mit/fen-bu-shi-xi-tong/24.html" class="sidebar-link">24.Project demos</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_23-peer-to-peer-bitcoin"><a href="#_23-peer-to-peer-bitcoin" class="header-anchor">#</a> 23.Peer-to-peer: Bitcoin</h1> <p>Bitcoin: A Peer-to-Peer Electronic Cash System, by Satoshi Nakamoto
2008</p> <p>why aren't credit cards the perfect digital money?</p> <ul><li>work online</li> <li>hard to steal (a complex situation)
+- can cancel transactions, call customer support</li></ul> <ul><li>relies on 3rd parties to verify (banks)
b/c users cannot directly verify charges</li> <li>3% fee</li> <li>long settling time</li> <li>hard to become a merchant
+- tied to currency controlled by government</li></ul> <p>bitcoin: e-money without a central trusted party
a public ledger: anyone can verify transactions</p> <p>what's hard technically?
forgery
double spending
theft</p> <p>what's hard socially/economically?
why does it have value?
how to pay for infrastructure?
monetary policy (intentional inflation &amp;c)
laws (taxes, laundering, drugs, terrorists)</p> <p>let's design OneBit, a simple e-money system
to illustrate a public, verifiable ledger using transaction chain
each user owns some coins
single server -- OneBank -- everyone talks to it
OneBank records all transactions</p> <p>OneBit transactions
every coin has a chain of transaction records
one for each time this coin was transferred as payment
OneBank maintains the complete chain for each coin
chain helps ensure that only the current owner spends</p> <p>what's in a OneBit transaction record?
public key of new owner
hash of this coin's previous transaction record
signed by private key of previous owner
(BitCoin is much more complex: amount (fractional), multiple in/out, ...)</p> <p>OneBit example:
Y owns a coin, previously given to it by X:
T7: pub(Y), hash(T6), sig(X)
Y buys a hamburger from Z and pays with this coin
Z tells Y Z's public key (&quot;address&quot;)
Y creates a new transaction and signs it
T8: pub(Z), hash(T7), sig(Y)
OneBank verifies that:
no other transaction mentions hash(T7),
T8's sig() corresponds to T7's pub()
Z waits until OneBank has seen/verified T8,
verifies that T8's pub() is Z's public key,
then Z gives hamburger to Y</p> <p>why include pub(Z)?</p> <p>why sign with sig(Y)?</p> <p>why include hash(T7)?
hash(T7) identifies the exact coin to be spent
a coin ID scheme might be ambiguous if Y owned this coin previously</p> <p>where is Z's resulting coin value &quot;stored&quot;?
coin balance = unspent xaction
the &quot;identity&quot; of a coin is the (hash of) its most recent xaction
Z &quot;owns&quot; the coin: has private key that allows Z to make next xaction</p> <p>does OneBit's transaction chain prevent stealing?
current owner's private key needed to sign next transaction
danger: attacker can steal Z's private key
Z uses private key a lot, so probably on his PC, easy to steal?
a significant problem for BitCoin in practice</p> <p>what if OneBank is corrupt?
it can't forge transactions (doesn't know private keys)
but it can help people double-spend!</p> <p>double-spending with OneBit
suppose OneBank is cooperating with Y to cheat Z or Q
Y creates two transactions for same coin: Y-&gt;Z, Y-&gt;Q
both have has pointing to same current end of chain
OneBank shows chain ending in Y-&gt;Z to Z, and Y-&gt;Q to Q
both transactions look good, including signatures and hash
now both Z and Q will give hamburgers to Y</p> <p>why was double-spending possible?
OneBank can <em>hide</em> some information,
or selectively reveal it</p> <p>what's needed?
many servers (&quot;peers&quot;)
send all transactions to all peers
much harder for a few bad peers to hide transactions
conventions to un-fork if problems do arise</p> <p>the BitCoin block chain
single block chain contains transactions on all coins
a copy stored in each peer
so each peer can validate new transactions against old ones
each block:
hash(prevblock)
set of transactions
&quot;nonce&quot; (not quite a nonce in the usual cryptographic sense)
current time (wall clock timestamp)
a transaction isn't real unless it's in the block chain
new block every 10 minutes containing xactions since prev block</p> <p>who creates each new block?
all the peers try
requirement: hash(block) &lt; &quot;target&quot;
peers try nonce values until this works out
can't predict a winning nonce, since cryptographic hash
trying one nonce is fast, but most nonces won't work
it would take one CPU months to create one block
but thousands of peers are working on it
such that expected time to first to find is about 10 minutes
the winner sends the new block to all peers
(this is part of &quot;mining&quot;)</p> <p>how do transactions work w/ block chain?
start: all peers know ...&lt;-B5
and are working on B6 (trying different nonces)
Z sends public key (address) to Y
Y sends Y-&gt;Z transaction to peers, which flood it
peers buffer the transaction until B6 computed
peers that heard Y-&gt;Z include it in next block
so eventually ...&lt;-B5&lt;-B6&lt;-B7, where B7 includes Y-&gt;Z</p> <p>what if bad person wants to double-spend?
start with block chain ...&lt;-B6
Y gets Y-&gt;Z into block chain
...&lt;-B6&lt;-BZ (BZ contains Y-&gt;Z)
Z will see Y-&gt;Z in chain and give Y a hamburger
can Y create ...&lt;-B6&lt;-BQ
and persuade peers to accept it in place of ...&lt;-B6&lt;-BZ?</p> <p>when will a peer accept chain CX it hears from another peer?
suppose peer already knows of chain CY
it will accept CX if len(CX) &gt; len(CY)
and if CX passes some validity tests
will not accept if len(CX) = len(CY): first chain of same length wins</p> <p>so attacker needs a longer chain to double-spend
e.g. ...&lt;-B6&lt;-BQ&lt;-B8, which is longer than ...&lt;-B6&lt;-BZ
and must create it in less than 10 minutes
<em>before</em> main chain grows by another block
10 minutes is the time it takes the 1000s of honest peers
to find one block
if the attacker has just one CPU, will take months to create the blocks
by that time the main chain will be much longer
no peer will accept the attacker's shorter chain
attacker has no chance
if the attacker has 1000s of CPUs -- more than all the honest
bitcoin peers -- then the attacker can double spend</p> <p>summary:
attacker can force honest peers to switch chains if attacker
controls majority of peer CPU power</p> <p>how long should Z wait before giving Y the hamburger?
until Z sees Y flood the transaction to many peers?
no -- not in the chain, Y might flood conflicting xaction
maybe OK for low-value transactions
until Z sees chain ...&lt;-BZ?
maybe
risky -- non-zero chance that some other chain will win
i.e. some lucky machine discovered a few blocks in a row
quickly, but its network msgs have so far been lost
perhaps that chain won't have Y-&gt;Z
probability goes down rapidly with number of blocks
until Z sees chain with multiple blocks after BZ?
yes -- slim chance attacker with few CPUs could catch up</p> <p>validation checks:
much of burden is on (honest) peers, to check new xactions/blocks
to avoid ever having to scan the whole block chain
and so that clients don't have to maintain the whole block chain
peer, new xaction:
no other transaction refers to same previous transaction
signature is by private key of previous transaction
[ then will add transaction to txn list for new block being mined ]
peer, new block:
hash value &lt; target (i.e. nonce is right, proof of work)
previous block hash exists
new chain longer than current chain
all transactions in block are valid
Z:
Y-&gt;Z is in a recent block
Z's public key / address is in the transaction
multiple peers have accepted that block
there's several more blocks in the chain
(other stuff has to be checked as well, lots of details)</p> <p>where does each bitcoin originally come from?
each time a peer creates a block, it gets 25 bitcoins
assuming it is the winner for that block
it puts its public key in a special transaction in the block
this is incentive for people to operate bitcoin peers
but that number halves every 210,000 blocks (abt 4 years)
the point: motivate people to run peers</p> <p>Q: how do peers communicate / find each other?</p> <p>Q: what prevents a bad peer from modifying an existing block?</p> <p>Q: what if two nodes disagree on the validity of a transaction?
(slight implementation differences between software versions)</p> <p>Q: 10 minutes is annoying; could it be made much shorter?</p> <p>Q: are transactions anonymous?  pseudonymous?  analogy: IP addresses.</p> <p>Q: can bitcoins be stolen?</p> <p>Q: if I steal bitcoins, is it safe to spend them?</p> <p>Q: what can adversary do with a majority of CPU power in the world?
can double-spend
cannot steal others' bitcoins
can prevent xaction from entering chain
can revert past xactions (by building longer chain from before that block)</p> <p>Q: how rich are you likely to get with one machine mining?</p> <p>Q: if more people (CPUs) mine, will that create new bitcoin faster?
important use of block timestamps: control difficulty (hash target)</p> <p>Q: why mine at all? why not start with a fixed number of coins?</p> <p>Q: why does it make sense for the mining reward to decrease with time?</p> <p>Q: is it a problem that there will be a fixed number of coins?</p> <p>Q: what if the real economy grows (or shrinks)?</p> <p>Q: why do bitcoins have value?
e.g., 1 BTC appears to be around US$242 on may 12th 2015.</p> <p>Q: will we still need banks, credit cards, &amp;c?
today, dollar bills are only a small fraction of total money
same may be true of bitcoin
so properties of bitcoin (anonymity &amp;c) may not be very important</p> <p>Q: what are the benefits of banks, credit cards, &amp;c?
disputes (Z takes payment and does not give hamburger to Y)
loss / recovery (user cannot find their private key)</p> <p>Q: will bitcoin scale well?
as transaction rate increases?
claim CPU limits to 4,000 tps (signature checks)
more than Visa but less than cash
as block chain length increases?
do you ever need to look at very old blocks?
do you ever need to xfer the whole block chain?
merkle tree: block headers vs txn data.</p> <p>key idea: block chain
public ledger is a great idea
decentralization might be good
mining seems imperfect, but does avoid centralized trust
tieing ledger to new currency seems bad</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">lastUpdate:</span> <span class="time">4/6/2021, 2:11:34 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/note/mit/fen-bu-shi-xi-tong/22.html" class="prev">
        22.Peer-to-peer: Trackerless Bittorrent and DHTs
      </a></span> <span class="next"><a href="/note/mit/fen-bu-shi-xi-tong/24.html">
        24.Project demos
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/note/assets/js/app.d5006f3d.js" defer></script><script src="/note/assets/js/2.65e5b2f3.js" defer></script><script src="/note/assets/js/104.1b5b375d.js" defer></script>
  </body>
</html>
