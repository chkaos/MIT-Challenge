# 11. Debugging

### 重现错误
首先找到一个小的可重复的产生故障的测试用例。如果该错误是通过回归测试发现的，那么您很幸运；您的测试套件中已经有一个失败的测试用例。如果该错误是由用户报告的，则可能需要花费一些精力才能重现该错误。对于图形用户界面和多线程程序，如果错误取决于事件或线程执行的时间，则可能很难一致地重现该错误。

### 了解错误的位置和原因

要定位错误及其原因，可以使用科学的方法：

- 研究数据: 查看导致错误的测试输入，错误的结果，失败的断言以及由此导致的堆栈跟踪。
- 假设: 提出一个与所有数据一致的关于错误可能存在或 不可能 存在的假设 。首先使这个假设具有普遍性是很好的。
- 实验: 设计一个测试您的假设的实验。首先让实验成为 观察 是个好 习惯-一个收集信息但尽可能少干扰系统的探针。
- 重复: 将您从实验中收集的数据添加到您以前知道的内容中，然后做出新的假设。希望您已经排除了一些可能性，并缩小了可能的位置以及错误原因的范围。
- 其他
  - 通过二进制搜索进行错误本地化
  - 优先考虑您的假设 
  - 交换组件, 控制变量
  - 确保您的源代码和目标代码是最新的
  - get Help or Sleep

### 修正错误
找到错误并了解其原因后，第三步是为它设计一个修复程序。避免在其上打补丁然后继续前进的诱惑。问问自己，该错误是编码错误（例如，拼写错误的变量或互换的方法参数）还是设计错误（例如，接口指定不足或不足）。设计错误可能会建议您退后一步，然后重新访问设计，或者至少考虑故障界面的所有其他客户端，以查看它们是否也受到错误的影响。

还请考虑该错误是否有亲戚。如果我刚刚在这里发现了一个除零错误，是否在代码的其他任何地方都做了？尝试使代码免受此类将来的错误侵害。还请考虑您的修复将产生什么影响。它会破坏其他任何代码吗？

最后，在应用修补程序后，将错误的测试用例添加到回归测试套件中，然后运行所有测试以确保自己（a）已修复该错误，并且（b）没有引入新的错误。